<?php
$response = MoSPT_ajax::mo_show_summary();
$jsonObject = $response;
$lowCount = 0;
$midCount = 0;
$highCount = 0;

if(isset($jsonObject["status"]) && $jsonObject["status"]=="FAILURE" & !isset($jsonObject["alerts"]))
    {
    $siteURL = site_url();
    $sslStatus ="not_scanned";
    $alerts = "not_scanned";
    }
else
    {
        $siteURL =  $jsonObject["@name"] ;
        $sslStatus = $jsonObject["@ssl"] ;
        $alerts =  $jsonObject["alerts"] ;

        usort($alerts,'sortByRiskFactor');
        foreach ($alerts as $alert)
        {
            switch ($alert["riskcode"])
            {
                case '1':
                case '0':
                    $lowCount++;
                    break;
                case '2':
                    $midCount++;
                    break;
                case '3':
                    $highCount++;
                    break;
            }
        }
    }

function sortByRiskFactor($riskOne,$riskTwo)
{
    return $riskOne["riskcode"]< $riskTwo["riskcode"];
}
include_once $MoSPTDirName . 'views' . DIRECTORY_SEPARATOR . 'SitePenTest_statistics.php';