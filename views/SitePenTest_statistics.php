<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<div class="mo_wpns_divided_layout">
<div class="mo_wpns_setting_layout" id="">
    <body class="c-app">
    <div class="c-wrapper">
        <div class="c-body" style="margin-top: 30px">
            <main class="c-main">
                <div class="container-fluid">
                    <div class="fade-in">
                        <div class="row" style="text-align: center">
                            <div class="col-sm-6 col-lg-3">
                                <div class="card text-white bg-gradient-primary">
                                    <div class="card-body card-body pb-0 justify-content-between align-items-start" >
                                        <div style="padding: 20px;margin-top: -47px;background-color: #c31b1b;color: white;font-size: x-large;border-radius: 8px;box-shadow: 0 4px 20px 0 rgba(255 0 0 / 40%), 0 7px 10px -5px rgba(255,152,0,.4);">High
                                        </div>
                                        <div style="width: 100%;text-align: center;">
                                            <div class="text-value-lg"  style="color: black"><h1><?php echo $highCount; ?></h1></div>
                                            <div class="mo-font-size" style="color: black;text-align: center">Vulnerabilities</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- /.col-->

                            <div class="col-sm-6 col-lg-3">
                                <div class="card text-white bg-gradient-info">
                                    <div class="card-body card-body pb-0 justify-content-between align-items-start" >
                                        <div style="padding: 20px;margin-top: -47px;background-color: #f9b115;color: white;font-size: x-large;border-radius: 8px;box-shadow: 0 4px 20px 0 rgba(0,0,0,.14), 0 7px 10px -5px rgba(255,152,0,.4);">Medium
                                        </div>
                                        <div style="width: 100%;text-align: center;">
                                            <div class="text-value-lg"  style="color: black"><h1><?php echo $midCount; ?></h1></div>
                                            <div class="mo-font-size" style="color: black">Vulnerabilities</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- /.col-->
                            <div class="col-sm-6 col-lg-3">
                                <div class="card text-white bg-gradient-info">
                                    <div class="card-body card-body pb-0 justify-content-between align-items-start" >
                                        <div style="padding: 20px;margin-top: -47px;background-color: #1fbd15;color: white;font-size: x-large;border-radius: 8px;box-shadow: 0 4px 20px 0 rgba(0,0,0,.14), 0 7px 10px -5px rgba(39 255 0 / 40%);">Low
                                        </div>
                                        <div style="width: 100%;text-align: center;">
                                            <div class="text-value-lg"  style="color: black"><h1><?php echo $lowCount; ?></h1></div>
                                            <div class="mo-font-size" style="color: black">Vulnerabilities</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">

                        </div>
                        <!-- /.row-->
                        <div class="row" id="scan_summary_id">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="card-body">
                                        <table class="table table-responsive-sm table-hover table-outline mb-0">
                                            <thead class="thead-light">
                                            <tr>
                                                <th class="text-center">
                                                    <i class="fa fa-exclamation-triangle" style="font-size:30px;"></i>
                                                </th>
                                                <th>Vulnerability Type</th>
                                                <th>Risk Factor</th>
                                                <th>Occurrence</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <?php
                                            if($alerts == "not_scanned")
                                            {
                                                echo '<tr style="cursor: pointer;">';
                                                echo '<td colspan="4" style="text-align: center;font-size: 18px;"><div>Site has not been Scanned yet</div></td>';
                                                echo '</tr>';
                                            }
                                            else
                                            foreach ($alerts as $alert)
                                            {
                                                $scrollId = '\''.str_replace(' ','_',strtolower($alert["name"])).'\'';
                                                echo '<tr style="cursor: pointer;" onclick="Vulnerability_details('.$scrollId.')">';
                                                switch ($alert['riskcode'])
                                                {
                                                    case '1':
                                                    case '0':
                                                        echo '<td class="text-center"><i class="fa fa-exclamation-triangle" style="font-size:30px;color:green"></i></td>';
                                                        break;
                                                    case '2':
                                                        echo '<td class="text-center"><i class="fa fa-exclamation-triangle" style="font-size:30px;color:orange"></i></td>';
                                                        break;
                                                    case '3':
                                                        echo '<td class="text-center"><i class="fa fa-exclamation-triangle" style="font-size:30px;color:red"></i></td>';
                                                        break;
                                                }
                                                echo '<td><div>'.$alert["name"].'</div>';
                                                echo '<td><div>'.$alert["riskdesc"].'</div></td>';
                                                echo '<td><div class="clearfix">'.$alert["count"].'</div></td></tr>';
                                            }
                                                    $siteName = site_url();
                                                    $siteName = "https://34.207.99.18/pentestwp";
                                                    if(strpos($siteName,'https://')!==false)
                                                    {
                                                        $siteName= str_replace('https://','',$siteName);
                                                    }
                                                    else if (strpos($siteName,'http://')!==false)
                                                    {
                                                        $siteName= str_replace('http://','',$siteName);
                                                    }
                                                    $siteName = str_replace('/','-',$siteName);
                                            ?>
                                            </tbody>
                                        </table>
                                            <div class="card-body p-3">

                                                <div class="row">
                                                    <div class="col">
                                                    </div>
                                                    <div class="col">
                                                        <button class="btn btn-block btn-success" type="button" <?php if($alerts=="not_scanned") echo "disabled"?> onclick="<?php echo "window.open('https://sitestats.xecurify.com/report/?hostName=$siteName')"?>">  View detailed Report </button>
                                                    </div>
                                                    <div class="col">

                                                    </div>
                                                </div>
                                                </div>
                                    </div>
                                </div>
                            </div>
                            <!-- /.col-->
                        </div>
                        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                        <script type="text/javascript">
                            google.charts.load("current", {packages:["corechart"]});
                            google.charts.setOnLoadCallback(drawChart);
                            function drawChart() {
                                var data = google.visualization.arrayToDataTable([
                                    ['Vuln', 'Count'],
                                    ['High : '+ '<?php echo $highCount?>',     <?php echo $highCount?> ],
                                    ['Medium: '+'<?php echo $midCount?>',   <?php echo $midCount?>],
                                    ['Low: '+'<?php echo $lowCount?>',      <?php echo $lowCount?>]
                                ]);

                                var options = {
                                    title: <?php if($alerts=="not_scanned") echo ""; else echo "Vulnerability Severity Graph"?>,
                                    pieHole: 0.4,
                                    colors: ['#f44336', '#ff9800', '#2e7d32', ],
                                };

                                var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
                                chart.draw(data, options);
                            }
                        </script>
                            <?php if($alerts=="not_scanned")
                        {
                            ?>
                            
                            <?php
                        }
                        else
                            {
                            ?>
                            <div style="text-align: center;">
                            <div id="donutchart" style="width: 100%; height: 500px;">
                            </div>
                            </div>
                            <?php
                            }
                            ?>
                        <!-- *********************************************************************** -->
                </div>
            </main>
        </div>
    </div>
    <script type="text/javascript">
        function Vulnerability_details(Timestamp_Disclosure)
        {
            var elmnt1 = Timestamp_Disclosure;
            var elmnt = document.getElementById(elmnt1);
            elmnt.scrollIntoView();
        }
    </script>
</div>
</div>
